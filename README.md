# ğŸ¨ Random Image API

[![Node.js](https://img.shields.io/badge/Node.js-16+-green.svg)](https://nodejs.org/)
[![License](https://img.shields.io/badge/License-MIT-blue.svg)](LICENSE)
[![Express](https://img.shields.io/badge/Express-4.x-lightgrey.svg)](https://expressjs.com/)

ä¸€ä¸ªåŠŸèƒ½å®Œæ•´çš„éšæœºå›¾ç‰‡APIæœåŠ¡ï¼Œæ”¯æŒå›¾ç‰‡åˆ†ç±»ã€æ–¹å‘ç­›é€‰ã€åå°ç®¡ç†ã€ç”¨æˆ·è®¤è¯å’Œç³»ç»Ÿè®¾ç½®ã€‚

## âœ¨ ç‰¹æ€§

### ğŸš€ æ ¸å¿ƒåŠŸèƒ½
- **éšæœºå›¾ç‰‡API**: æ”¯æŒåˆ†ç±»å’Œæ–¹å‘ç­›é€‰çš„é«˜æ€§èƒ½å›¾ç‰‡æœåŠ¡
- **å¤šæ ¼å¼æ”¯æŒ**: ç›´æ¥å›¾ç‰‡è®¿é—®å’ŒJSONæ ¼å¼æ•°æ®
- **å›¾ç‰‡ç®¡ç†**: æ”¯æŒæœ¬åœ°ä¸Šä¼ å’ŒURLé“¾æ¥ä¸¤ç§æ–¹å¼
- **æ™ºèƒ½åˆ†ç±»**: 6å¤§åˆ†ç±»ï¼ˆé£æ™¯ã€åŠ¨æ¼«ã€ç¾å¥³ã€è‡ªç„¶ã€åŸå¸‚ã€è‰ºæœ¯ï¼‰
- **æ–¹å‘æ”¯æŒ**: æ¨ªå±/ç«–å±è‡ªåŠ¨è¯†åˆ«å’Œç­›é€‰

### ğŸ¯ ç®¡ç†åŠŸèƒ½
- **ç¼©ç•¥å›¾ç³»ç»Ÿ**: è‡ªåŠ¨ç”Ÿæˆå¤šå°ºå¯¸ç¼©ç•¥å›¾ï¼Œæ”¯æŒæ‡’åŠ è½½
- **æ‰¹é‡æ“ä½œ**: æ”¯æŒæ‰¹é‡åˆ†ç±»ä¿®æ”¹å’Œåˆ é™¤
- **åˆ†é¡µç®¡ç†**: é«˜æ•ˆåˆ†é¡µåŠ è½½ï¼Œæ”¯æŒå¤§é‡å›¾ç‰‡
- **æ•°æ®ç»Ÿè®¡**: å®æ—¶ç»Ÿè®¡å„åˆ†ç±»å›¾ç‰‡æ•°é‡
- **ç”¨æˆ·ç®¡ç†**: å®Œæ•´çš„ç”¨æˆ·æ³¨å†Œã€å®¡æ‰¹å’Œæƒé™ç®¡ç†
- **ç³»ç»Ÿè®¾ç½®**: æ³¨å†Œæ§åˆ¶ã€ç»´æŠ¤æ¨¡å¼ã€ç”¨æˆ·é™åˆ¶ç­‰
- **å®æ—¶æœç´¢**: æ”¯æŒå…³é”®è¯ã€åˆ†ç±»ã€æ–¹å‘å¤šç»´æœç´¢
- **æœç´¢å»ºè®®**: æ™ºèƒ½å…³é”®è¯æç¤ºå’Œçƒ­é—¨æ¨è
- **é‚®ä»¶æœåŠ¡**: æ³¨å†Œç¡®è®¤å’Œå¯†ç é‡ç½®é‚®ä»¶

### ğŸ”’ å®‰å…¨ç‰¹æ€§
- **åŒé‡è®¤è¯**: JWT + SessionåŒé‡è®¤è¯æœºåˆ¶
- **éªŒè¯ç ä¿æŠ¤**: SVGéªŒè¯ç é˜²æ­¢è‡ªåŠ¨åŒ–æ”»å‡»
- **è®¿é—®æ§åˆ¶**: IP/åŸŸåé»‘ç™½åå•ç®¡ç†
- **é¢‘ç‡é™åˆ¶**: å¤šçº§APIè¯·æ±‚é¢‘ç‡é™åˆ¶
- **å®‰å…¨å¤´éƒ¨**: Helmetå®‰å…¨ä¸­é—´ä»¶
- **ç»´æŠ¤æ¨¡å¼**: æ”¯æŒç³»ç»Ÿç»´æŠ¤æ—¶çš„è®¿é—®æ§åˆ¶
- **å¼‚å¸¸æ£€æµ‹**: æ™ºèƒ½å¯ç–‘æ´»åŠ¨æ£€æµ‹å’Œè‡ªåŠ¨å°ç¦
- **æ–‡ä»¶å®‰å…¨**: å®Œæ•´çš„æ–‡ä»¶ä¸Šä¼ å®‰å…¨éªŒè¯
- **è·¯å¾„ä¿æŠ¤**: é˜²è·¯å¾„éå†æ”»å‡»
- **SQLæ³¨å…¥é˜²æŠ¤**: å‚æ•°åŒ–æŸ¥è¯¢å’Œè¾“å…¥éªŒè¯

### âš¡ æ€§èƒ½ä¼˜åŒ–
- **æ•°æ®åº“ç´¢å¼•**: 12ä¸ªå…³é”®ç´¢å¼•ä¼˜åŒ–æŸ¥è¯¢æ€§èƒ½
- **ç¼©ç•¥å›¾ä¼˜åŒ–**: æ™ºèƒ½ç¼©ç•¥å›¾ç”Ÿæˆå’Œç¼“å­˜ç­–ç•¥
- **Workerçº¿ç¨‹æ± **: é«˜æ€§èƒ½å¹¶è¡Œå›¾ç‰‡å¤„ç†
- **æ‡’åŠ è½½æœºåˆ¶**: Intersection Observerå®ç°å›¾ç‰‡æ‡’åŠ è½½
- **ç»Ÿè®¡APIä¼˜åŒ–**: ä¸“é—¨çš„ç»Ÿè®¡ç«¯ç‚¹é¿å…å¤§æ•°æ®åŠ è½½
- **CORSæ”¯æŒ**: é»˜è®¤æ”¯æŒè·¨åŸŸè®¿é—®
- **å¥åº·æ£€æŸ¥**: å†…ç½®å¥åº·æ£€æŸ¥ç«¯ç‚¹
- **æ€§èƒ½ç›‘æ§**: å®æ—¶å“åº”æ—¶é—´å’Œå†…å­˜ç›‘æ§

### ğŸ“Š åˆ†æç»Ÿè®¡
- **ä½¿ç”¨åˆ†æ**: è¯¦ç»†çš„APIè°ƒç”¨ç»Ÿè®¡å’Œç”¨æˆ·è¡Œä¸ºåˆ†æ
- **å®‰å…¨ç›‘æ§**: å¯ç–‘æ´»åŠ¨æ£€æµ‹å’Œè®°å½•
- **æ€§èƒ½ç›‘æ§**: å“åº”æ—¶é—´å’Œé”™è¯¯ç‡ç»Ÿè®¡
- **è‡ªåŠ¨ç»´æŠ¤**: å®šæ—¶æ¸…ç†å’Œä¼˜åŒ–ä»»åŠ¡

## ğŸ› ï¸ æŠ€æœ¯æ ˆ

- **åç«¯**: Node.js + Express.js
- **æ•°æ®åº“**: SQLite (è½»é‡çº§ï¼Œæ˜“äºéƒ¨ç½²)
- **å›¾ç‰‡å¤„ç†**: Sharp (é«˜æ€§èƒ½å›¾ç‰‡å¤„ç†åº“)
- **è®¤è¯**: Express-session + Bcryptjs
- **å®‰å…¨**: Helmet, CORS, Rate-limiting
- **æ—¥å¿—**: Winston (ç»“æ„åŒ–æ—¥å¿—è®°å½•)
- **æµ‹è¯•**: Jest (å•å…ƒæµ‹è¯•æ¡†æ¶)

## ğŸ“¦ å®‰è£…éƒ¨ç½²

### Dockeréƒ¨ç½² (æ¨è)

```bash
# å…‹éš†é¡¹ç›®
git clone https://github.com/whai38001/random-image-api.git
cd random-image-api

# å¤åˆ¶ç¯å¢ƒé…ç½®
cp .env.docker .env
# ç¼–è¾‘ .env æ–‡ä»¶ï¼Œè®¾ç½®æ‚¨çš„é…ç½®

# å¯åŠ¨æœåŠ¡
docker-compose up -d

# è®¿é—®åº”ç”¨
# å‰å°: http://localhost:3001
# åå°: http://localhost:3001/admin
```

### æœ¬åœ°éƒ¨ç½²

```bash
# å…‹éš†é¡¹ç›®
git clone https://github.com/whai38001/random-image-api.git
cd random-image-api

# å®‰è£…ä¾èµ–
npm install

# å¤åˆ¶ç¯å¢ƒé…ç½®
cp .env.example .env
# ç¼–è¾‘ .env æ–‡ä»¶ï¼Œè®¾ç½®æ‚¨çš„é…ç½®

# å¯åŠ¨æœåŠ¡
npm start

# æˆ–è€…å¼€å‘æ¨¡å¼å¯åŠ¨
npm run dev
```

## ğŸ”§ ç¯å¢ƒé…ç½®

åˆ›å»º `.env` æ–‡ä»¶å¹¶é…ç½®ä»¥ä¸‹å‚æ•°ï¼š

```env
# åº”ç”¨é…ç½®
NODE_ENV=production
PORT=3001

# å®‰å…¨é…ç½®
SESSION_SECRET=your-super-secret-session-key
JWT_SECRET=your-super-secret-jwt-key-change-in-production

# æ•°æ®åº“é…ç½®
DB_PATH=./config/images.db

# HTTPSé…ç½®
HTTPS=false
COOKIE_SECURE=false

# CORSé…ç½®
CORS_ORIGIN=*

# é™æµé…ç½®
RATE_LIMIT_WINDOW=15
RATE_LIMIT_MAX=1000
LOGIN_RATE_LIMIT=5

# æ—¥å¿—é…ç½®
LOG_LEVEL=info
```

## ğŸš€ APIæ¥å£

### è·å–éšæœºå›¾ç‰‡

```bash
# è·å–éšæœºå›¾ç‰‡
GET /api/random

# æŒ‡å®šåˆ†ç±»
GET /api/random?category=landscape

# æŒ‡å®šæ–¹å‘
GET /api/random?orientation=portrait

# æŒ‡å®šåˆ†ç±»å’Œæ–¹å‘
GET /api/random?category=anime&orientation=landscape
```

### å›¾ç‰‡ç®¡ç†API

```bash
# è·å–æ‰€æœ‰å›¾ç‰‡ (åˆ†é¡µ)
GET /api/images?page=1&limit=12

# è·å–ç‰¹å®šå›¾ç‰‡
GET /api/images/:id

# ä¸Šä¼ å›¾ç‰‡
POST /api/images

# æ›´æ–°å›¾ç‰‡
PUT /api/images/:id

# åˆ é™¤å›¾ç‰‡
DELETE /api/images/:id
```

### æœç´¢API

```bash
# ç»¼åˆæœç´¢
GET /api/search?query=keyword&category=nature&orientation=landscape&type=local&sort=newest&page=1&limit=12

# æœç´¢å»ºè®®
GET /api/search/suggestions?q=keyword&limit=5

# çƒ­é—¨å…³é”®è¯
GET /api/search/popular?limit=10

# è·å–æ‰€æœ‰åˆ†ç±»
GET /api/search/categories

# å¿«é€Ÿè¿‡æ»¤
GET /api/search/filter?type=local&orientation=landscape
```

### ç»Ÿè®¡API

```bash
# è·å–å›¾ç‰‡ç»Ÿè®¡ä¿¡æ¯
GET /api/stats

# è·å–APIä½¿ç”¨ç»Ÿè®¡
GET /api/analytics
```

## ğŸ‘¨â€ğŸ’¼ åå°ç®¡ç†

è®¿é—® `/admin` è¿›å…¥åå°ç®¡ç†ç³»ç»Ÿï¼Œé»˜è®¤ç®¡ç†å‘˜è´¦æˆ·ï¼š
- ç”¨æˆ·å: `admin`
- å¯†ç : `admin123`

> âš ï¸ **é‡è¦**: é¦–æ¬¡ç™»å½•åè¯·ç«‹å³ä¿®æ”¹é»˜è®¤å¯†ç ï¼

### ç®¡ç†åŠŸèƒ½åŒ…æ‹¬ï¼š
- å›¾ç‰‡ä¸Šä¼ å’Œç®¡ç†
- ç”¨æˆ·è´¦æˆ·ç®¡ç†
- ç³»ç»Ÿé…ç½®è®¾ç½®
- å®‰å…¨è®¿é—®æ§åˆ¶
- ç»Ÿè®¡æ•°æ®åˆ†æ

## ğŸ” å®‰å…¨è¯´æ˜

1. **é»˜è®¤è´¦æˆ·**: é¦–æ¬¡å¯åŠ¨ä¼šåˆ›å»ºé»˜è®¤ç®¡ç†å‘˜è´¦æˆ·ï¼Œè¯·ç«‹å³ä¿®æ”¹å¯†ç 
2. **ä¼šè¯å®‰å…¨**: ä½¿ç”¨å®‰å…¨çš„Sessionå¯†é’¥ï¼Œå»ºè®®åœ¨ç”Ÿäº§ç¯å¢ƒä¸­æ›´æ”¹
3. **JWTè®¤è¯**: ä½¿ç”¨å¼ºéšæœºå¯†é’¥çš„JWTä»¤ç‰Œè®¤è¯
4. **è®¿é—®æ§åˆ¶**: æ”¯æŒIPé»‘ç™½åå•å’ŒåŸŸåé™åˆ¶
5. **é¢‘ç‡é™åˆ¶**: é˜²æ­¢APIæ»¥ç”¨å’Œæš´åŠ›ç ´è§£æ”»å‡»
6. **HTTPSæ”¯æŒ**: æ”¯æŒHTTPSéƒ¨ç½²ï¼Œæé«˜ä¼ è¾“å®‰å…¨æ€§

è¯¦ç»†å®‰å…¨é…ç½®è¯·æŸ¥çœ‹ [å®‰å…¨æ–‡æ¡£](docs/SECURITY.md) å’Œ [JWTè®¤è¯è¯´æ˜](docs/JWT.md)ã€‚

## ğŸ“ é¡¹ç›®ç»“æ„

```
random-image-api/
â”œâ”€â”€ config/           # æ•°æ®åº“é…ç½®æ–‡ä»¶
â”œâ”€â”€ public/           # é™æ€èµ„æºæ–‡ä»¶
â”‚   â”œâ”€â”€ uploads/      # ä¸Šä¼ çš„å›¾ç‰‡æ–‡ä»¶
â”‚   â””â”€â”€ admin/        # åå°ç®¡ç†ç•Œé¢
â”œâ”€â”€ src/              # æºä»£ç ç›®å½•
â”‚   â”œâ”€â”€ routes/       # è·¯ç”±å¤„ç†
â”‚   â”œâ”€â”€ models/       # æ•°æ®æ¨¡å‹
â”‚   â”œâ”€â”€ middleware/   # ä¸­é—´ä»¶
â”‚   â””â”€â”€ utils/        # å·¥å…·å‡½æ•°
â”œâ”€â”€ docs/             # è¯¦ç»†æ–‡æ¡£
â”œâ”€â”€ logs/             # æ—¥å¿—æ–‡ä»¶
â”œâ”€â”€ .env              # ç¯å¢ƒé…ç½®æ–‡ä»¶
â”œâ”€â”€ Dockerfile        # Dockeré…ç½®
â””â”€â”€ docker-compose.yml # Dockerç¼–æ’é…ç½®
```

## ğŸ³ Dockeræ”¯æŒ

é¡¹ç›®æä¾›å®Œæ•´çš„Dockeræ”¯æŒï¼ŒåŒ…å«ï¼š
- åº”ç”¨å®¹å™¨
- Nginxåå‘ä»£ç† (å¯é€‰)
- ç›‘æ§æœåŠ¡ (å¯é€‰)

```bash
# åŸºç¡€æœåŠ¡
docker-compose up -d

# åŒ…å«Nginxä»£ç†
docker-compose --profile nginx up -d

# åŒ…å«ç›‘æ§æœåŠ¡
docker-compose --profile monitoring up -d

# å…¨éƒ¨æœåŠ¡
docker-compose --profile nginx --profile monitoring up -d
```

## ğŸ“Š ç›‘æ§å’Œæ—¥å¿—

### æ—¥å¿—çº§åˆ«
- `error`: é”™è¯¯ä¿¡æ¯
- `warn`: è­¦å‘Šä¿¡æ¯
- `info`: ä¸€èˆ¬ä¿¡æ¯
- `debug`: è°ƒè¯•ä¿¡æ¯

### ç›‘æ§ç«¯ç‚¹
- `/health`: å¥åº·æ£€æŸ¥
- `/metrics`: æ€§èƒ½æŒ‡æ ‡ (å¦‚æœå¯ç”¨ç›‘æ§)

## ğŸ¤ è´¡çŒ®

æ¬¢è¿æäº¤ Issue å’Œ Pull Requestï¼

### è´¡çŒ®æŒ‡å—

1. Fork é¡¹ç›®
2. åˆ›å»ºç‰¹æ€§åˆ†æ”¯ (`git checkout -b feature/AmazingFeature`)
3. æäº¤æ›´æ”¹ (`git commit -m 'Add some AmazingFeature'`)
4. æ¨é€åˆ°åˆ†æ”¯ (`git push origin feature/AmazingFeature`)
5. æäº¤ Pull Request

### å¼€å‘è§„èŒƒ

- ä½¿ç”¨ ESLint è¿›è¡Œä»£ç æ£€æŸ¥
- æäº¤å‰è¿è¡Œæµ‹è¯•
- ä¿æŒä»£ç æ³¨é‡Šå®Œæ•´
- éµå¾ªç°æœ‰ä»£ç é£æ ¼

## ğŸ“„ è®¸å¯è¯

æœ¬é¡¹ç›®é‡‡ç”¨ MIT è®¸å¯è¯ - æŸ¥çœ‹ [LICENSE](LICENSE) æ–‡ä»¶äº†è§£è¯¦æƒ…ã€‚

## ğŸ“ æ”¯æŒ

å¦‚æœæ‚¨è§‰å¾—è¿™ä¸ªé¡¹ç›®æœ‰ç”¨ï¼Œè¯·ç»™å®ƒä¸€ä¸ª â­ï¸ï¼

- **Issues**: [GitHub Issues](https://github.com/whai38001/random-image-api/issues)
- **è®¨è®º**: [GitHub Discussions](https://github.com/whai38001/random-image-api/discussions)

## ğŸ™ è‡´è°¢

- [Express.js](https://expressjs.com/) - Webæ¡†æ¶
- [Sharp](https://sharp.pixelplumbing.com/) - å›¾ç‰‡å¤„ç†
- [SQLite](https://www.sqlite.org/) - æ•°æ®åº“
- [Unsplash](https://unsplash.com/) - æµ‹è¯•å›¾ç‰‡æ¥æº
- [Pixabay](https://pixabay.com/) - æµ‹è¯•å›¾ç‰‡æ¥æº

---

<div align="center">

**[â¬† å›åˆ°é¡¶éƒ¨](#-random-image-api)**

Made with â¤ï¸ by [whai38001](https://github.com/whai38001)

</div>